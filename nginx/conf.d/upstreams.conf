# Upstream definitions for load balancing

# Backend API - Single server (can be extended for load balancing)
upstream backend_api {
    least_conn;
    server backend:8080 max_fails=3 fail_timeout=30s;
    # Add more backend instances for load balancing:
    # server backend2:8080 max_fails=3 fail_timeout=30s;
    # server backend3:8080 max_fails=3 fail_timeout=30s;
    keepalive 32;
}

# Frontend - Single server (can be extended for load balancing)
upstream frontend_app {
    least_conn;
    server frontend:3000 max_fails=3 fail_timeout=30s;
    # Add more frontend instances for load balancing:
    # server frontend2:3000 max_fails=3 fail_timeout=30s;
    keepalive 32;
}

# Prometheus - Monitoring
upstream prometheus {
    server prometheus:9090 max_fails=3 fail_timeout=30s;
    keepalive 16;
}

# Grafana - Monitoring
upstream grafana {
    server grafana:3000 max_fails=3 fail_timeout=30s;
    keepalive 16;
}
